#compdef {{programs}}

typeset -A opt_args
_arguments -s -S \
  {{flags}} \
  "*: :->command"

case $state in
  command)
    local history_file=${opt_args[--history]:-{{history_file}}}
    local choices=()
    if [[ -f $history_file ]]; then
      while read -r line; do
        choices+=(${(q)line})
      done < $history_file
    fi
    _arguments "*:word:($choices)"
    ;;
esac
